# OpenFilz Docker Environment Configuration
#
# Copy this file to .env and customize as needed:
#   cp .env.example .env
#
# All variables have sensible defaults for development.

# =============================================================================
# Database Configuration
# =============================================================================
# PostgreSQL version (use 16 or 17 for stability, avoid 18+ due to breaking changes)
POSTGRES_IMAGE=postgres:17
DB_NAME=dms_db
DB_USER=dms_user
DB_PASSWORD=dms_password
DB_PORT=5432

# =============================================================================
# API Configuration
# =============================================================================
OPENFILZ_API_IMAGE=ghcr.io/openfilz/openfilz-api:latest
API_PORT=8081
JAVA_OPTS=-Xmx512m -Xms256m
CORS_ALLOWED_ORIGINS=http://localhost:4200,http://localhost:80

# =============================================================================
# Web Configuration
# =============================================================================
OPENFILZ_WEB_IMAGE=ghcr.io/openfilz/openfilz-web:latest
WEB_PORT=4200

# =============================================================================
# Frontend Configuration (used for ngx-env.js generation)
# =============================================================================
NG_APP_API_URL=http://localhost:8081/api/v1
NG_APP_GRAPHQL_URL=http://localhost:8081/graphql/v1
NG_APP_AUTHENTICATION_ENABLED=false
NG_APP_AUTHENTICATION_AUTHORITY=http://localhost:8180/realms/openfilz
NG_APP_AUTHENTICATION_CLIENT_ID=openfilz-web
NG_APP_ONLYOFFICE_ENABLED=false

# =============================================================================
# Storage Configuration (used with docker-compose.minio.yml)
# =============================================================================
# STORAGE_TYPE: local (default) or minio
STORAGE_TYPE=local

# MinIO settings (only used when STORAGE_TYPE=minio)
MINIO_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=openfilz-bucket
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# =============================================================================
# Security Configuration (used with docker-compose.auth.yml)
# =============================================================================
# Set to true to disable authentication (development only)
OPENFILZ_SECURITY_NO_AUTH=true

OPENFILZ_INTERNAL_API_BASE_URL=http://openfilz-api:8081
OPENFILZ_PUBLIC_API_BASE_URL=http://localhost:8081

OPENFILZ_SOFTDELETE_ACTIVE=true

# Enable file checksum calculation (SHA-256) on upload
OPENFILZ_CALCULATECHECKSUM=false

# Keycloak settings (only used when OPENFILZ_SECURITY_NO_AUTH=false)
KEYCLOAK_IMAGE=ghcr.io/openfilz/keycloak:26.5
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin
KEYCLOAK_PORT=8180
KEYCLOAK_MANAGEMENT_PORT=9000
# Keycloak database (auto-created by init-keycloak-db.sh on first postgres startup)
KEYCLOAK_DB_USER=keycloak
KEYCLOAK_DB_PASSWORD=keycloak
KEYCLOAK_DB_NAME=keycloak_db
# Internal Docker URL for Keycloak realm (used by API for JWK fetching)
# This uses internal Docker DNS (keycloak:8080) instead of localhost
KEYCLOAK_REALM_URL=http://keycloak:8080/realms/openfilz
# Public URL for Keycloak (used as frontendUrl in realm import)
KEYCLOAK_PUBLIC_URL=http://localhost:8180
# Client root URL for openfilz-web (used in realm import for rootUrl, redirectUris, etc.)
KEYCLOAK_CLIENT_ROOT_URL=http://localhost:4200
# Default roles assigned to new users (used in realm import)
# Up to 4 role slots. Available roles: READER, CONTRIBUTOR, AUDITOR, CLEANER
# Set unused slots to an already-used role (duplicates are ignored by Keycloak)
# Example for all permissions: CONTRIBUTOR, AUDITOR, CLEANER, READER
KEYCLOAK_DEFAULT_ROLE_1=READER
KEYCLOAK_DEFAULT_ROLE_2=READER
KEYCLOAK_DEFAULT_ROLE_3=READER
KEYCLOAK_DEFAULT_ROLE_4=READER
# Default groups assigned to new users (used in realm import)
# Up to 4 group slots. Available groups: /OPENFILZ/READER, /OPENFILZ/CONTRIBUTOR, /OPENFILZ/AUDITOR, /OPENFILZ/CLEANER
# Set unused slots to an already-used group (duplicates are ignored by Keycloak)
KEYCLOAK_DEFAULT_GROUP_1=/OPENFILZ/READER
KEYCLOAK_DEFAULT_GROUP_2=/OPENFILZ/READER
KEYCLOAK_DEFAULT_GROUP_3=/OPENFILZ/READER
KEYCLOAK_DEFAULT_GROUP_4=/OPENFILZ/READER

# =============================================================================
# SMTP Configuration (Keycloak emails, used in realm import)
# =============================================================================
# Leave SMTP_HOST empty to disable email sending in Keycloak
SMTP_HOST=
SMTP_PORT=587
SMTP_FROM=
SMTP_SSL=false
SMTP_STARTTLS=true
SMTP_AUTH=true
SMTP_USER=
SMTP_PASSWORD=

# =============================================================================
# Identity Providers / Social Login (used in Keycloak realm import)
# =============================================================================
# Leave empty to disable the corresponding identity provider
# Google OAuth2
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
# GitHub OAuth2
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
# Microsoft OAuth2
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=

# =============================================================================
# OnlyOffice Configuration (used with docker-compose.onlyoffice.yml)
# =============================================================================
ONLYOFFICE_ENABLED=false
ONLYOFFICE_PORT=8080
ONLYOFFICE_URL=http://localhost:8080
ONLYOFFICE_JWT_SECRET=openfilz-onlyoffice-jwt-secret-2024

# =============================================================================
# Full-Text Search Configuration (used with docker-compose.fulltext.yml)
# =============================================================================
OPENFILZ_FULLTEXT_ACTIVE=false
OPENSEARCH_PORT=9200
OPENSEARCH_PERF_PORT=9600
OPENSEARCH_DASHBOARDS_PORT=5601
